@using System.Globalization
<div id="kt_app_header" class="app-header align-items-stretch">
 <div class="app-container container-fluid d-flex align-items-stretch justify-content-between"
      id="kt_app_header_container">
  <div class="d-flex align-items-center justify-content-between flex-row-fluid" id="kt_app_header_wrapper">
   <div class="app-header-logo d-flex align-items-center">
    <div class="d-flex align-items-center d-lg-none ms-n2 me-2" title="Show sidebar menu">
     <div class="btn btn-icon btn-active-color-primary w-35px h-35px" id="kt_app_header_menu_toggle">
      <i class="ki-outline ki-abstract-14 fs-2"></i>
     </div>
    </div>
    <a href="/" class="me-5 me-lg-9">
     <img alt="Logo" src="img/logo.svg"
          class="h-50px h-lg-60px theme-light-show"/>
     <img alt="Logo" src="img/logo-white.svg"
          class="h-50px h-lg-60px theme-dark-show"/>
    </a>
   </div>
   <div class="d-flex align-items-stretch" id="kt_app_header_menu_wrapper">
    <div class="app-header-menu app-header-mobile-drawer align-items-stretch"
         data-kt-drawer="true"
         data-kt-drawer-name="app-header-menu"
         data-kt-drawer-activate="{default: true, lg: false}"
         data-kt-drawer-overlay="true"
         data-kt-drawer-width="{default:'200px', '300px': '250px'}"
         data-kt-drawer-direction="start"
         data-kt-drawer-toggle="#kt_app_header_menu_toggle"
         data-kt-swapper="true"
         data-kt-swapper-mode="prepend"
         data-kt-swapper-parent="{default: '#kt_app_body', lg: '#kt_app_header_menu_wrapper'}">
     <div
      class="menu menu-rounded menu-column menu-lg-row menu-active-bg menu-title-gray-600 menu-state-primary menu-arrow-gray-500 fw-semibold fw-semibold fs-6 align-items-stretch my-5 my-lg-0 px-2 px-lg-0"
      id="#kt_app_header_menu" data-kt-menu="true">
      <div class="menu-item me-0 me-lg-2">
       <NavLink href="/">
        <span class="menu-link">
         <span class="menu-icon">
          <i class="fas fa-home fs-3"></i>
         </span>
         <span class="menu-title">@Loc["Home"]</span>
        </span>
       </NavLink>
      </div>
      <div data-kt-menu-trigger="{default: 'click', lg: 'hover'}"
           data-kt-menu-placement="bottom-start" data-kt-menu-offset="12,0"
           class="menu-item menu-lg-down-accordion menu-sub-lg-down-indention me-0 me-lg-2">
       <span class="menu-link">
        <span class="menu-icon"><i class="fas fa-location fs-3"></i></span>
        <span class="menu-title">@Loc["Destination"]</span><span class="menu-arrow d-lg-none"></span>
       </span>
       <div class="menu-sub menu-sub-lg-down-accordion menu-sub-lg-dropdown px-lg-2 py-lg-4 w-lg-200px">
        <div class="menu-item">
         <NavLink href="/china" class="menu-link">
          <span class="menu-bullet">
           <span class="bullet bullet-dot"></span>
          </span>
          <span class="menu-title">@Loc["China"]</span>
         </NavLink>
        </div>
        <div class="menu-item">
         <NavLink href="/asia" class="menu-link">
          <span class="menu-bullet">
           <span class="bullet bullet-dot"></span>
          </span>
          <span class="menu-title">@Loc["Asia"]</span>
         </NavLink>
        </div>
        <div class="menu-item">
         <NavLink href="/japan" class="menu-link">
          <span class="menu-bullet">
           <span class="bullet bullet-dot"></span>
          </span>
          <span class="menu-title">@Loc["Japan"]</span>
         </NavLink>
        </div>
        <div class="menu-item">
         <NavLink href="/korea" class="menu-link">
          <span class="menu-bullet">
           <span class="bullet bullet-dot"></span>
          </span>
          <span class="menu-title">@Loc["Korea"]</span>
         </NavLink>
        </div>
        <div class="menu-item">
         <NavLink href="/india-nepal" class="menu-link">
          <span class="menu-bullet">
           <span class="bullet bullet-dot"></span>
          </span>
          <span class="menu-title">@Loc["India Nepal"]</span>
         </NavLink>
        </div>
       </div>
      </div>
      <div data-kt-menu-trigger="{default: 'click', lg: 'hover'}"
           data-kt-menu-placement="bottom-start" data-kt-menu-offset="12,0"
           class="menu-item menu-lg-down-accordion menu-sub-lg-down-indention me-0 me-lg-2">
       <span class="menu-link"><span class="menu-icon"><i
          class="fas fa-compass fs-3"></i></span><span
         class="menu-title">@Loc["Services"]</span><span class="menu-arrow d-lg-none"></span></span>
       <div
        class="menu-sub menu-sub-lg-down-accordion menu-sub-lg-dropdown px-lg-2 py-lg-4 w-lg-200px">
        <div class="menu-item">
         <NavLink class="menu-link"
                  href="/visa">
          <span
           class="menu-bullet"><span class="bullet bullet-dot fs-2"></span></span>
          <span
           class="menu-title">Visa</span>
         </NavLink>
        </div>
        <div class="menu-item">
         <NavLink class="menu-link"
                  href="/ancillary">
          <span
           class="menu-bullet"><span class="bullet bullet-dot fs-2"></span></span>
          <span
           class="menu-title">@Loc["Ancillary"]</span>
         </NavLink>
        </div>
       </div>
      </div>
      <div data-kt-menu-trigger="{default: 'click', lg: 'hover'}"
           data-kt-menu-placement="bottom-end" data-kt-menu-offset="12,0"
           class="menu-item menu-lg-down-accordion menu-sub-lg-down-indention me-0 me-lg-2">
       <span class="menu-link"><span class="menu-icon"><i
          class="fas fa-globe-asia fs-3"></i></span><span
         class="menu-title">@Loc["Our Company"]</span><span class="menu-arrow d-lg-none"></span></span>
       <div
        class="menu-sub menu-sub-lg-down-accordion menu-sub-lg-dropdown px-lg-2 py-lg-4 w-lg-600px">
        <div class="row">
         <div class="col-md-4">
          <h4 class="fs-6 fs-lg-4 fw-bold mb-3 ms-4">DTour</h4>
          <div class="menu-item">
           <NavLink class="menu-link"
                    href="/about-us">
            <span
             class="menu-bullet"><span class="bullet bullet-line fs-2"></span></span>
            <span
             class="menu-title">@Loc["About Us"]</span>
           </NavLink>
          </div>
          <div class="menu-item">
           <NavLink class="menu-link"
                    href="/careers">
            <span
             class="menu-bullet"><span class="bullet bullet-line fs-2"></span></span>
            <span
             class="menu-title">@Loc["Careers"]</span>
           </NavLink>
          </div>
         </div>
         <div class="col-md-4">
          <h4 class="fs-6 fs-lg-4 fw-bold mb-3 ms-4">@Loc["News"]</h4>
          <div class="menu-item">
           <NavLink class="menu-link"
                    href="/mice">
            <span
             class="menu-bullet"><span class="bullet bullet-line fs-2"></span></span>
            <span
             class="menu-title">@Loc["DTour News"]</span>
           </NavLink>
          </div>
          <div class="menu-item">
           <NavLink class="menu-link"
                    href="/team-building">
            <span
             class="menu-bullet"><span class="bullet bullet-line fs-2"></span></span>
            <span
             class="menu-title">@Loc["Travel Guide"]</span>
           </NavLink>
          </div>
         </div>
         <div class="col-md-4">
          <h4 class="fs-6 fs-lg-4 fw-bold mb-3 ms-4">@Loc["Gallery"]</h4>
          <div class="menu-item">
           <NavLink class="menu-link"
                    href="/mice">
            <span
             class="menu-bullet"><span class="bullet bullet-line fs-2"></span></span>
            <span
             class="menu-title">MICE</span>
           </NavLink>
          </div>
          <div class="menu-item">
           <NavLink class="menu-link"
                    href="/team-building">
            <span
             class="menu-bullet"><span class="bullet bullet-line fs-2"></span></span>
            <span
             class="menu-title">Team Building</span>
           </NavLink>
          </div>
          <div class="menu-item">
           <NavLink class="menu-link"
                    href="/tour-requested">
            <span
             class="menu-bullet"><span class="bullet bullet-line fs-2"></span></span>
            <span
             class="menu-title">@Loc["Tour By Requested"]</span>
           </NavLink>
          </div>

         </div>
        </div>
       </div>
      </div>
      <div class="menu-item me-0 me-lg-2">
       <NavLink href="/">
        <span class="menu-link">
         <span class="menu-icon">
          <i class="fas fa-contact-card fs-3"></i>
         </span>
         <span class="menu-title">@Loc["Contact Us"]</span>
        </span>
       </NavLink>
      </div>
     </div>
    </div>
   </div>
   <div class="app-navbar flex-shrink-0">
    <div class="app-navbar-item me-3">
     <div class="btn btn-icon btn-icon-gray-600 border border-dashed border-gray-300 w-35px h-35px w-md-40px h-md-40px me-3"
          data-kt-menu-trigger="{default: 'click', lg: 'hover'}"
          data-kt-menu-attach="parent"
          data-kt-menu-placement="bottom-end">
      <img class="h-25 h-md-30px" src="img/@(languageDefault).svg" alt="lang"/>
     </div>
     <div
      class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg menu-state-color fw-semibold py-4 fs-6 w-200px"
      data-kt-menu="true">
      <div class="menu-item px-5 my-1">
       <div @onclick="()=>ApplySelectedCultureAsync(0)" class="menu-link px-5">
        <span class="menu-title position-relative">
         @Loc["English"]
         <span class="fs-8 rounded bg-light px-3 py-2 position-absolute translate-middle-y top-50 end-0">
          <img class="w-15px h-15px rounded-1 ms-2" src="img/en.svg"
               alt=""/>
         </span>
        </span>
       </div>
      </div>
      <div class="menu-item px-5 my-1">
       <div @onclick="()=>ApplySelectedCultureAsync(1)" class="menu-link px-5">
        <span class="menu-title position-relative">
         @Loc["Vietnamese"]
         <span class="fs-8 rounded bg-light px-3 py-2 position-absolute translate-middle-y top-50 end-0">
          <img class="w-15px h-15px rounded-1 ms-2" src="img/vi.svg"
               alt=""/>
         </span>
        </span>
       </div>
      </div>
     </div>
     <div class="app-navbar-item ms-2">
      <AuthorizeView>
       <Authorized>
        <a href="/Agent"
           class="btn btn-flex btn-icon btn-success align-self-center fw-bold h-35px w-md-100 py-2 px-4">
         <i class="ki-duotone ki-abstract-30 fs-4">
          <span class="path1"></span>
          <span class="path2"></span>
         </i>
         <span class="d-none d-md-inline ms-1 fs-7">@Loc["Agent"]</span>
        </a>
       </Authorized>
       <NotAuthorized>
        <a href="/Account/Login"
           class="btn btn-flex btn-icon btn-secondary align-self-center fw-bold h-35px w-md-100 py-2 px-4">
         <i class="fas fa-sign-in fs-4"></i>
         <span class="d-none d-md-inline ms-1 fs-7">@Loc["Log in"]</span>
        </a>
       </NotAuthorized>
      </AuthorizeView>
     </div>
    </div>
   </div>
  </div>
 </div>
</div>


@code{

 private CultureInfo[] supportedCultures =
 [
  new("en-US"),
  new("vi-VN")
 ];

 private string languageDefault = "vi";

 protected override void OnInitialized()
 {
  languageDefault = CultureInfo.CurrentCulture.Name[..2];
 }

 private async Task ApplySelectedCultureAsync(int index)
 {
  var selected = supportedCultures[index];
  if (!Equals(CultureInfo.CurrentCulture, selected))
  {
   await CallJs("appCulture.set", selected.Name);

   //NavigationManager.NavigateTo(NavigationManager.Uri, forceLoad: true);
   var uri = new Uri(NavigationManager.Uri)
    .GetComponents(UriComponents.PathAndQuery, UriFormat.Unescaped);
   var cultureEscaped = Uri.EscapeDataString(selected.Name);
   var uriEscaped = Uri.EscapeDataString(uri);

   NavigationManager.NavigateTo(
    $"Culture/Set?culture={cultureEscaped}&redirectUri={uriEscaped}",
    forceLoad: true);
  }
 }
}